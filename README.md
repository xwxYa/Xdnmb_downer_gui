# Xdnmb_downer_gui
X岛匿名版的下载工具（GUI版）

### 请勿用于违法用途，工具仅供学习交流使用，所下载及生成的文件版权属于X岛匿名版与原作者所有，请在24小时内删除

本意用于打包缓存小说版的文章，顺便提供更好的阅读体验

生成后的TXT、EPUB与Markdown文件均位于.tmp文件夹内

## 安装依赖

```bash
pip install -r requirements.txt
```

**注意**：只需要安装 `requests` 库，无其他依赖

## 快速开始

### GUI版本（推荐）

**启动程序**：
- Windows：双击 `run_gui.bat` 或运行 `python gui.py`
- Linux/Mac：执行 `bash run_gui.sh` 或 `python3 gui.py`

**使用步骤**：

#### 📥 单串下载
1. 点击"打开X岛"按钮，在浏览器中登录（如已登录可跳过）
2. 按F12打开开发者工具，在Console（控制台）输入 `document.cookie` 并回车
3. 复制输出的Cookie，粘贴到程序的Cookie输入框，点击"保存"
4. 输入串ID（如：51340998）或直接粘贴串网址
5. 选择下载模式（所有回复/只下载PO的回复）
6. 选择输出格式（EPUB/TXT/Markdown）
7. 可选：设置自定义标题和内容过滤
8. 点击"开始下载"，文件保存在`.tmp`文件夹

#### 📚 订阅批量下载（新功能）
1. 切换到"订阅批量下载"Tab页
2. 获取订阅UUID（点击"UUID获取教程"查看详细方法）：
   - 访问X岛订阅页面
   - 按F12打开开发者工具 → Network标签
   - 刷新页面，找到包含 `feed/uuid/` 的请求
   - 从URL中复制UUID（例如：`https://api.nmb.best/Api/feed/uuid/XXXXXXXX/page/1` 中的 `XXXXXXXX`）
3. 在UUID输入框粘贴UUID，点击"获取订阅列表"
4. 勾选想要下载的串（支持全选/反选/清空操作）
5. 选择输出格式（EPUB/TXT/Markdown）
6. 点击"开始批量下载"
7. 文件按时间戳和串内容组织：`.tmp/订阅_时间戳/串内容前100字/文件.格式`

**功能特点**：
- **Tab页签界面**：单串下载和订阅批量下载独立Tab页，操作互不干扰
- **订阅批量下载**：一键下载所有订阅串，支持勾选、预览、错误恢复
  - 可视化订阅列表：显示串ID、标题、内容预览、回复数、最后回复时间
  - 灵活选择：全选/反选/清空快捷操作
  - 自动组织：按时间戳创建文件夹，每个串独立子文件夹
  - 智能命名：使用串主内容前100字命名文件夹，易于识别
  - 进度统计：实时显示成功/失败数量，详细错误日志
- **智能内容过滤**：三种过滤模式提升阅读体验
  - 自动过滤短回复（≤25字且无图片）
  - 智能过滤无意义回复（fy、mark、jmjp等）
  - 手动审核模式（逐条确认）
  - 可视化词汇表管理
- **双下载模式**：支持下载所有回复或只下载PO的回复
- **增量更新**：缓存机制支持串更新后只下载新回复
- **实时日志显示**和过滤统计
- **多格式导出**：
  - **EPUB**：适合电子书阅读器
  - **TXT**：纯文本格式，自动添加回复分割线
  - **Markdown**：支持两种模式
    - 在线图片模式：图片使用网络URL，文件轻量
    - 本地图片模式：图片下载到本地，支持相对/绝对路径，完美离线阅读

### 命令行版本

`python run.py`

如果喜欢自定义可以自己修改main.py

`python main.py`

## Cookie获取说明

初次使用请先获取cookies，有以下几种方式：

### 方式一：使用开发者工具（推荐）
1. 打开浏览器访问 https://www.nmbxd1.com 并登录
2. 按 F12 打开开发者工具
3. 切换到 "Console"（控制台）标签
4. 在底部输入 `document.cookie` 并回车
5. 复制输出的内容（以 PHPSESSID= 开头）
6. 粘贴到程序的Cookie输入框

### 方式二：使用书签工具
1. 创建书签，URL填入：
   ```javascript
   javascript:(function(){let domain=document.domain;let cookie=document.cookie;prompt('Cookies: '+domain, cookie)})();
   ```
2. 访问 https://www.nmbxd1.com 并登录
3. 点击书签，复制弹出的Cookie内容
4. 粘贴到程序的Cookie输入框

## 订阅UUID获取说明

订阅批量下载功能需要订阅UUID，获取方法如下：

### 方法一：使用开发者工具（推荐）
1. 打开浏览器访问 https://www.nmbxd1.com 并登录
2. 进入"订阅"页面
3. 按 F12 打开开发者工具
4. 切换到 "Network"（网络）标签
5. 刷新页面
6. 在网络请求列表中找到包含 `feed/uuid/` 的请求
7. 点击该请求，从URL中复制UUID
   - 例如：`https://api.nmb.best/Api/feed/uuid/XXXXXXXX/page/1`
   - UUID就是 `XXXXXXXX` 部分

### 方法二：从浏览器URL获取
1. 在X岛网站进入订阅页面
2. 查看浏览器地址栏URL
3. 如果URL包含UUID参数，直接复制


## 文件结构示例

### 单串下载
```
.tmp/
  ├── 串标题.epub
  ├── 串标题.txt
  ├── 串标题.md
  └── 串标题_files/       (Markdown本地图片模式)
      └── images/
          ├── image1.jpg
          └── image2.png
```

### 订阅批量下载
```
.tmp/
  └── 订阅_2025-12-03_14-30-00/
      ├── 【综合】大家都在看什么书/
      │   ├── 【综合】大家都在看什么书.epub
      │   ├── 【综合】大家都在看什么书.txt
      │   └── 【综合】大家都在看什么书.md
      ├── 【欢乐恶搞】今天发生的搞笑事/
      │   └── ...
      └── 【技术交流】Python学习心得/
          └── ...
```

## 题外话

> 版权的代码我直接摆在你脸上了，反正公开的东西想搞事的谁也拦不住
>
> 不搞编译了，没用的东西.jpg
